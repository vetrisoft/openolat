<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<applicationDocs targetNamespace="http://research.sun.com/wadl/2006/10">

    <doc xml:lang="en" title="Documentation of OLAT REST API">
         The goal of the REST API is to provide an easy way to exchange
         URLs. It is also used to integrate with other systems such as student
         administration, external course administration and/or external learning group
         administration.&lt;/p&gt;
         
         &lt;h2&gt;Concepts&lt;/h2&gt;
         &lt;p&gt;Representational State Transfer or REST is a style of architecture to be primarily used with
         the HTTP protocol, but not exclusively. In the case of HTTP, it utilizes all 
         its features: URIs to describe resources, HTTP Methods as "verbs" to manipulate resources 
         (GET to retrieve resources, PUT to create new ones, POST to modify them, DELETE...),
         HTTP Headers and Media Types for content negotiation...&lt;/p&gt;
         &lt;p&gt;In OLAT, the JRS-311 is used as a backend for the implementation of our REST API. JSR-311 is a standard
         from J2EE. We use the reference implementation from the following standard: &lt;a href="https://jersey.dev.java.net/"&gt;Jersey&lt;/a&gt;.&lt;/p&gt;
         &lt;img src="schema.jpg" title="schema" /&gt;
         
         &lt;h2&gt;Security&lt;/h2&gt;
         &lt;p&gt;The security is based on a two level mechanism, as it is in OLAT.&lt;/p&gt;
         &lt;ol&gt;
         	&lt;li&gt;The first level is a servlet filter which collects all requests to the REST API. This filter
         	determines whether the URI is open to everyone (/api, /ping, /auth...) or if it needs an authentication. The authentication
         	itself is delegated to a web service.&lt;/li&gt;
         	&lt;li&gt;The second level happens in all entry points of the REST API. Every method checks if
         	the user (if a user must be authenticated) has enough privileges to operate on the desired resource.&lt;/li&gt;
         &lt;/ol&gt;
         &lt;p&gt;To maintain a valid authentication over several requests, the filter proposes two methods:&lt;/p&gt;
         &lt;ol&gt;
         	&lt;li&gt;Reuse the session cookie on every request. The advantage of this method is that OLAT
         	doesn't need to create a session on every request.&lt;/li&gt;
         	&lt;li&gt;If you cannot use the session cookie, the filter always adds an HTTP Header (X-OLAT-TOKEN) to
         	the response. Send this token with the next request to maintain your privileges.&lt;/li&gt;
         &lt;/ol&gt;
         
         &lt;h2&gt;Configuration&lt;/h2&gt;
         &lt;p&gt;A spring bean allows to configure Resources, Singletons and Providers; either statically
         with the XML configuration of the bean (&lt;code&gt;/org/olat/connectors/rest/_spring/restApiContext.xml&lt;/code&gt;) or
         programmatically by adding or removing classes and singletons to/from the bean (bean id is the
         same as its interface: &lt;code&gt;org.olat.connectors.rest.support.RestRegistrationService&lt;/code&gt;).&lt;/p&gt;
         &lt;p&gt;OLAT uses the standard JAXB provider from Jersey to produce XML from java objects, as well as 
         the JSON provider from &lt;a href="http://jackson.codehaus.org/"&gt;Jackson&lt;/a&gt;, which reuses
         the same JAXB annotations.&lt;/p&gt; 
         &lt;p&gt;&lt;strong&gt;Very important!&lt;/strong&gt; All configuration settings must be done before the Jersey's servlet starts.&lt;/p&gt;
         
         &lt;h2&gt;Example&lt;/h2&gt;
         &lt;p&gt;Here is a little example on how to create a user and add it to a learning group:&lt;/p&gt;
         &lt;ol&gt;
         	&lt;li&gt;PUT http://www.frentix.com/olat/restapi/users&lt;br /&gt;
         	HTTP Header: Content-Type application/json&lt;br /&gt;
         	Response: 200&lt;/li&gt;
         	&lt;li&gt;GET http://www.frentix.com/olat/restapi/groups&lt;br /&gt;
         	HTTP Header: Accept application/json&lt;br /&gt;
         	Response: 200&lt;/li&gt;
         	&lt;li&gt;Choose a group&lt;/li&gt;
         					&lt;li&gt;PUT http://www.frentix.com/olat/restapi/groups/{groupId}/users/{identityKey}&lt;br /&gt;
         					Response: 200&lt;/li&gt;
         &lt;/ol&gt;
         
         &lt;h2&gt;Documentation&lt;/h2&gt;
         &lt;p&gt;This documentation is based on the WADL format. The XML file is automatically
         generated by Jersey on runtime. For documentation purposes, this file is the base
         of a four step Maven process to produce a human readable HTML file.&lt;/p&gt;
         &lt;ol&gt;
         	&lt;li&gt;Generate a XSD schema from all the Java classes used by JAXB for mapping&lt;/li&gt;
         	&lt;li&gt;Generate Javadoc with a custom doclet for WADL&lt;/li&gt;
         	&lt;li&gt;Generate WADL with the output of the two preceding steps&lt;/li&gt;
         	&lt;li&gt;Produce the final HTML documentation with XSLT&lt;/li&gt;
         &lt;/ol&gt;
         &lt;p&gt;To add java classes annoted with JAXB, you must update the pom file in the OLAT directory
         under the artfact &lt;code&gt;maven-jaxb-schemagen-plugin&lt;/code&gt;.&lt;/p&gt;
         &lt;p&gt;To add resources, you must add the packages to the following plugins configurations:
         &lt;code&gt;maven-javadoc-plugin&lt;/code&gt; and &lt;code&gt;maven-wadl-plugin&lt;/code&gt;.
         Be aware that the first uses commas to seperates the packages and the second semicolons. Both  recursively search all resources under the packages.&lt;/p&gt;
         &lt;p&gt;Examples for the documentation can only be generated for XML. This is a limitation of the
         maven plugin.&lt;/p&gt;
         
				&lt;h2&gt;Contents of resources&lt;/h2&gt;
        &lt;p&gt;
    </doc>
    
</applicationDocs>