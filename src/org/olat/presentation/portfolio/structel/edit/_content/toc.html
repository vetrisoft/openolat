<div class="b_eportfolio_toolbar">

$r.render("deleteButton")

#if($r.available("addElement")) 
 $r.render("addElement") 
#end

</div>

<script type="text/javascript">
/* <![CDATA[ */
function myjsCallback(dragOverEvent) { 
	// the following members can be getted from the dragOverEvent:
	// tree - The TreePanel
	// target - The node being targeted for the drop
	// data - The drag data from the drag source
	// point - The point of the drop - append, above or below
	// source - The drag source
	// rawEvent - Raw mouse event
	// dropNode - Drop node(s) provided by the source.
	// cancel - Set this to true to signal drop not allowed.

	var node = dragOverEvent.dropNode;
	var nodeDeep = node.getDepth();

	// append -> add as child; above -> at same level above; below -> at same level above
	var newParent = (dragOverEvent.point == 'append' ? dragOverEvent.target : dragOverEvent.target.parentNode);
	
	var allowChild = newParent.allowChildren;
	// no drop on artefacts
	if (!allowChild) return false;
	var parentDeep = newParent.getDepth();
	
	//console.log(node.attributes.text + " nodeDeep: " + nodeDeep + " targetDeep: "+ parentDeep);

	// no drop on root
	if (parentDeep == 0) return false;
	// no drop on map/root
	if (nodeDeep == 3 && (parentDeep == 1 || parentDeep == 0)) return false;
	// moving a page/struct to struct is not possible
	if (nodeDeep <= 3 && parentDeep==3 && node.allowChildren) return false;
	// moving a page to page is not possible
	if (nodeDeep == 2 && parentDeep==2 && node.allowChildren) return false;	
	
	return true;
}
/* ]]> */
</script>

$r.render("tocTree")